오후 3:37 2020-11-26
https://codepen.io/joezimjs/pen/yPWQbd

버튼은 했는데 파일명안보여서 그냥 안 함.
특이하게도, 라벨이 클릭을 받아. 여러가지로 잘 쓰겠군.
input 자체는 숨기고 말야.ㅇㅋ.

1310720...25..하면서 증가했다
초지ㅗㅇ 파일 사이즈는 3743327
300키로바이트짜리였겠군!..이아니라
3.56메가였다.
3.743.327
ㅇㅋ. 바이트단위라이거지.
다되면100인거고.
a/b*100하면 최대 100 만족일거야.
a*100/b인것에 유의. 이게낫군.
||는.. or인데,, 초과시 100인가?

1021 || 100
0이면 or연산이라서 100이 뜨고 만다.아하.
1 || 100 이면 일단 1이먼저 선언되어서 1 뜸.신기한 표시로군.

파이썬도 동일함. 이거 되게 유용한 팁이겠어.
x or 100 있는경우, x가 0이면 100을 띄워준다.자동채움이네!
ㅎㅎㅎ잘됨.

왜!안된다는겁니까! 같은 느낌이 든다.
1.로그인하고
2.게시판,분류 선택하라
해야지 뭐.
와...400메가짜리도 잘 들어감.굿.

투고하기도, 경고문 넣자.ㅇㅇ.

오후 4:31 2020-11-26
30초기다렸더니 busy뜨면 곤란하다싶다.
체크버튼이라도 달까.
그리고 그걸 스레드클릭하는거지. 5초마다..

일단 차차 하고

폴더이미있음은,최저한의 안전장치랄까로 두자.

로그인 체크 띄움. 함수를 return해서 탈출하게.훌륭함.
if(logincheck()==false){return false}
이 한줄로 되다니 넘 멋지다. return의return은 쉽지않은듯.

일단 잘 되고요.
오후 4:38 2020-11-26
일단 다 되었다.진행중에 스트레스 못 느낌.

오후 5:12 2020-11-26
gif 올리는경우 8초는걸리길래 이미지에도 프로그레스바넣음.ㅇㅋ.

후후후.

파워레벨기준으로 500...1000..식으로하는건 남았다만,하지말기!

그..락이 안 되네요.
아.매번 찰나의 수행때만 이게 잠긴다.그래서그럼.아하..

jar 안에, 별개로 들어가는건 좋은데
계정별로 폴더그냥만들까??하..

지금도 이미 jar 안에 나름 그렇긴한데
ㄴㄴ.
일단 아무튼, jar 안에서라면 그렇게..싶다.


1.zip업로드시는,알아서굳어버림.ㅇㅋ.
ㄴ파일읽기전에 먼저 체크해야하지싶은데..

2. img업로드시는, 개별로 들어가버려서 곤란해!

즉,업로드 버튼 누르고 뭐라도 들어오는 순간 락을 걸고,
락 해제는,모든것이 끝난, txt 후에 하자.ㅇㅋ.

젤 좋은건 리퀘스트 선발대 먼저 보내서, ok 받은 후에 하는건데.
말야.

될듯.ㅇㅇ.


1.zip이나 img나, 시행 전에 로그인등 전처리 한 후에
마지막으로, 지금 jar 비었냐고 보낸다.
2.비었으니 잠갔다고 응답 오면, 안심하고 ㄱㄱ.

이러면 중간에 busy! 뜨는 경우는 제발 없길 바람..하..
원리적으로 탄탄해야겠어.

요청 없이는, 보내봤자,잠근사람이 일치하질 않으니 안 들어와.
인것이야.
되게 보안적으로 되어버렸군;


1.잠금
2.파일처리. 네임이 일치해야 업로드 됨.
3.

동시에 zip 올리면서 단일파일들 올려버리는 경우는???
원칙상 이것도 가능하니 곤란하긴하군.흠..


오후 5:35 2020-11-26
개별전송시 , token을 보내는것이상의 불필요한 낭비가 발생한다.
토큰의 사용성을 극대화 하기 위해, jar 안에 개별 폴더를 생성하고
그 안에 집어넣기로 한다.

개별 connection마다 폴더를 따로 생성하는게 궁극이겠군.
그러면,밀폐되어서 수행 가능하다.ㅇㅋ.

지금 파일 전송이라는 본질에 너무 덕지덕지붙어서
zip은 단일처리, 전송완료시 락 해제
img는 단일처리,밀폐, 혹시매번 jar 안잠겼으면잠그기,
txt가 jar를 다시 해제

이런식으로 너무 비명시적 소통이 발생하므로
간단히하기로함.ㅇㅋ.

비록 고작 js변조에의한 지연을 막기위해서라지만, 손실이 너무 크다.
애초에 그런 일 자체가 안 발생하도록 하는게 좋고

병렬사용이 된단걸 극대화하는게 좋지 싶다.

물론 db쓰기같은거도 락 개념이 있긴 하지만 말야.

그냥 락,언락을 명시할까 싶기도 한데,
다중 사용자가 단일 스토리지에 접근하는 상황에서

1.스레드잠금
2.할일다하고.
3.스레드해제.

인데, 2번에서, 사용자 변조에 의한 악성 침투가 가능한게
차이점이야. 밀폐된 서버 시스템이라면 이 변조가 없음.

1.내가잠근다
2.내가쓴다
3.내가해제한다

가 안되니까. 2번에서 남이 쓰는경우, 곤란하지.그게 변조가 된단것.

따라서,각자 계정이 컨넥션을 발생시키고,
커넥션당 폴더를 배정받고,
업로드를 수행한다.

...?! 파일을 무작정 저장하는게 아니라면?

아무튼 zip 열심히 올리고있는데, 단일파일보내기버튼
을 누르는 경우도 같이 막고싶은거야.

1.zip파일 업로드네요! jar가 비어있으니 잠그겠습니다.
2.업로드처리중...
3.업로드완료및 처리완료. jar를 해제합니다.

1.img파일업로드네요! jar가비어있으니..처리함..
2..txt는없나보군요-----이게발생안하게하지뭐.ㅇㅇ.
3.txt를받아서 처리 완료했습니다. jar를 해제합니다.

txt받아서해야 getJar를 수행하니까 결국 그게그거네.ㅇㅋ.

젤 좋은건 커넥션 키를 js가 받아야 해.
그래야, 같은 신분증으로 진입 요청해도 튕기지.이거구나싶다..

오후 6:14 2020-11-26
음..

클라측 변조를 감안하고, 타임아웃을 하고
오버라이드까지하면 매우 곤란해지긴한다.

되게 간단한게있으려나.

오후 7:15 2020-11-26
키를받아야지.매번 토큰보내는게이상했어.개념상 구분하길.
오후 7:58 2020-11-26
작업재개.

1.key를 받아 오고, 쿠키에 저장하지말고, var로 보유하고있자.ㅇㅋ.


그... titletext하고 bodytext도..불필요한게아닌지에 대해서...

1.get upload key 를 하고,
token을 보낸다.
jar 가 프리하면,
upload_key
를 보내고,

titletext가 문제인데,이게폴더로 간주되었잖아.

이걸, 현재 해당 jar 이용자의 폴더로..바로넣도록.

img나 txt나 통일할까? 그래야, 그래야 mp4도 업로드되지싶어.
흠..

텍스트는 좀 상황이 다른게, parse해서 txt로 만들어야함.
파일전송이 아니라 이거지.


txtup을 받고 나서도, 후처리를 하게할까?

zip은 지금 단일응답이고.


그, 헤더마냥, title,body를 미리 전송하자.그게좋겠네!

1.헤더. 현재가진관련모든정보와 token을 보낸다. 받으면 jar lock.
2.이후 파일이라할걸 전송함.

이게낫지싶음.

get by..를 빼버리고 파일자체에대한걸 수행하니까 좋지.

zip이나 img나 공통규격으로하고싶어.ㅇㅇ.
파일전송(파일, 업로드키)

만 단일로 두되, 전후에서 처리를 하는거지.
응 그게낫겠다.

오후 8:41 2020-11-26

1.jar 체크. 헤더도 보냄. 글 본문은요??흠;;;
분리하지.

---token보내서
1.jar체크.

----키받은경우,첨부해서
2.txt보냄.
2.img보냄.

2.zip보냄.
-------------
3더보낼것없으면, key를 반납한다.
로 종료.

훨 간단하네. js변조는 애초에 의도적인거니, 타임아웃으로 되겠지뭐.

이상 구조의 문제는, 중간에 꺼버리는경우야. 이건 곤란하네.

체크인-체크아웃의 구조를 가지기에.


흠.
